---
title: ElasticSearch笔记简单的集群管理(二)
date: 2020-08-11 13:59:35
tags: [elasticSearch笔记]
---

## 操作
```
es提供了一套api:叫做 cat api,可以查看es中各种各样的数据

1. 快速检查集群健康状态
GET  /_cat/health?v

state: 
  1.green:主shard和副本shard都属于active状态
  2.yellow: 主shard是active状态,部分副本shard处于不可用
  3.red: 集群不可用


2.快速查看集群中有哪些索引

GET /_cat/indices?v

3.简单的索引操作
创建索引:PUT /test_index?pretty

删除索引: delete /test_index?pretty


```
<!--more-->

## 分布式机制
```
1.分片
直接插入document进入集群自动分配到某个shard中

2.cluster discovery
集群发现机制 
新节点自动加入集群

3. shard负载均衡
举例:
    假设现在有3个节点.总共25个shard要分配到3个节点上去,
  es会自动进行均匀分配,以保持每个节点的均匀的读写负载均衡

4.shard副本

5.请求路由

6.集群扩容

7.shard重分配

```

## 垂直扩容和水平扩容
```
垂直扩容:
  原先 2T*4=8T的服务器,现在
  直接购买两台4T的服务器 替换掉旧的容量服务器
   变为 2T*2+4T*2=12T
   
水平扩容 (常用方案 直接加机器就可以了)
  加入两台服务器进入集群
  在原先基础上 8T+4*2T

扩容对程序的透明性

```
###     增加或减少节点时候数据rebalance
会自动转移shard到不同的机子尽量
保持负载均衡

### master节点
master节点不存具体数据
```
只保留
1. 管理es集群的元数据
2.比如说: 索引 创建和删除
3.维护索引元数据
4.节点的增加和移动
5.维护集群的元数据
6.默认情况下,会自动选择出一台节点,作为master节点
7.master节点不承载所有的请求,所以不会是一个单点瓶颈

```

### 节点对等的分布式架构
```
1.节点对等,每个节点都能接受所有的请求
2.自动请求路由
(比如请求到一个shard上发现不在该shard上,会转移到另外一个能处理的shard上)
所以随便发给某个节点都可以,请求哪个shard都一样
3.响应收集
```