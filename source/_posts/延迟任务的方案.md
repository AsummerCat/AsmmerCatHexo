---
title: 延迟任务的方案
date: 2019-11-07 14:33:56
tags: [java,SpringBoot,调优]
---

# 延迟任务(不是立即生效的 不是立即开启一个线程处理) 比如外卖下单 15分钟超时处理

## 方案一  (数据库实现)

基于数据库 添加后 轮训查询这个 轮询

操作:  定时轮询数据库  发现超时任务 执行处理结果 

```java
优点:实现简单 

缺点:印象数据库性能 失效性差,效率低
```

## 方案二 (jdk的DelayedQueue实现)

基于jdk 的 延迟队列 处理 设置超时  无界队列 (系统关闭 丢失队列)

```java
优点:实现简单,性能高效

缺点 :处理容灾差
```

<!--more-->

## 方案三(redis实现)

基于redis的Zset 有序集合  while 处理 (高可用 但是无法处理超时后的)

```java
优点:解耦 ,扩展性强,支持分布式
```



## 方案四 (基于rabbitMQ 实现 )

基于rabbitMQ 实现  发送->队列(不处理消息 设置过期时间)->超时 ->被移除后->死信队列 处理请求 (完成)  

```java
优点:解耦 性能强
```

