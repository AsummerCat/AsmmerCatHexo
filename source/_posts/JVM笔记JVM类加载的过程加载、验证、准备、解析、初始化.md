---
title: JVM笔记JVM类加载的过程加载、验证、准备、解析、初始化
date: 2020-07-22 14:54:59
tags: [JVM笔记]
---

# JVM笔记JVM类加载的过程加载、验证、准备、解析、初始化
## 加载
```
加载一般可以分为显示加载（Class.forName()加载类）和隐式加载（new 类）。
这个过程主要完成三件事：

通过类全名/路径获取该类的class文件的二进制字节流。  
将class中的静态区域结构转化成JVM方法区运行时的数据结构。
在内存中生成一个代表这个类的java.lang.Class对象，作为数据访问这个类的唯一入口。
验证
这一步骤确保加载的这个类符合jvm规范和安全。
包括验证文件格式验证，字节码验证，二进制验证，符号引用验证，元数据验证。
```
<!--more-->

## 准备
```
为静态变量设置初始值，如static int i = 10;这时候的int赋值的是默认值0，而不是10，static String a="qwe"，string的默认值null，
但是也有两个意外，就是final static int = 10，这个静态常量将被赋值10,而跳过赋默认值的过程。
还有个意外就是实例变量，这个对象在实例化的时候会和该对象一起存放于堆中。
```

## 解析
```
把常量池中的符号引用转换成直接引用。
符号引用的意思是比如申明一个对象final String a = "qwe";转换为字节码后会生成一个变量如CAPTISOT_ausith_mw,表示我这个对象还没进入内存，只是可以直接定位到目标。
直接引用是直接只想目标的指针、相对偏移量和一个能间接定位到该常量所在内存的地址的句柄。
符号引用说明该常量没进入到内存，直接引用相反
```

## 初始化
```
clinit()，这个方法就是初始化时会执行的方法。
这个过程就是开始执行类中的字节码文件的过程。
clinit的主要作用是初始化成员变量和静态资源，赋予我们定义的值。
这个方法时线程安全的，多个线程要进行初始化时，只有一个会初始化成功
。这个该类没有成员变量和静态资源，那么不会生成clinit方法。
```