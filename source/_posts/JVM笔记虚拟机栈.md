---
title: JVM笔记虚拟机栈
date: 2020-07-22 14:53:04
tags: [JVM笔记]
---

# JVM笔记虚拟机栈

## 栈可能出现的常见异常
Java虚拟机规范允许Java栈大小是固定的或者动态扩展的
```
1.StackOverflowError异常: 超出虚拟机栈允许的最大容量

2.OutOfMemoryError异常:
如果Java虚拟机栈可以动态扩展->内存不足,无法申请到足够的内存

```
<!--more-->

## 设置栈大小
```
JVM参数:
 -Xss1024k
 
默认情况下:
linxu X64-bit  = 1024k
macOS X64-bit  = 1024k
windows   取决于实际内存
```

## 栈的存储结构和运行原理

### 栈的存储单位
 每个在运行方法对应一个栈帧  
 1.每个方法的执行表示:入栈   
 2.每个方法的终止表示:出栈  
![栈的存储单位](/img/2020-07-02/8.png)

### 运行原理
`先进后出 LFLO`  
![运行原理](/img/2020-07-02/9.png)  
![栈帧只能在本线程使用](/img/2020-07-02/10.png)

### 栈的内部结构
![栈的内部结构](/img/2020-07-02/11.png)    

#### 局部变量表
![局部变量表](/img/2020-07-02/12.png)   
![调用深度](/img/2020-07-02/13.png)   
```
局部变量表里:
存放的是:编译期可知的基本数据类型(8种),
引用类型(reference),retuanAddress类型的变量
```
### 操作数栈

### 动态链接
![动态链接](/img/2020-07-02/14.png)   

### 返回地址
![返回地址](/img/2020-07-02/17.png)   


## 本地方法栈
![本地方法栈](/img/2020-07-02/19.png) 



## 虚方法和非虚方法
![虚方法和非虚方法](/img/2020-07-02/16.png)   
![虚方法和非虚方法](/img/2020-07-02/15.png)  



## 本地方法接口
JNI 和本地方法包  
![什么是本地方法](/img/2020-07-02/18.png)  